ARG BASE_IMAGE=alpine
ARG ALPINE_VERSION=3.10
FROM ${BASE_IMAGE}:${ALPINE_VERSION}
LABEL org.label-schema.schema-version="1.0.0-demo" \
    maintainer="anish2good@yahoo.co.in" \
    org.label-schema.vcs-description="0cloud.com" \
    org.label-schema.docker.cmd="docker run -d -p 8082:8080 " \
    image-size="71.6MB" \
    ram-usage="13.2MB to 70MB" \
    cpu-usage="Low"

ENV NAMESPACE=cloud \
    MASTER=https://10.64.83.49:6443 \
    CACERTDATA=LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUN5RENDQWJDZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRFNU1EY3pNVEV4TkRZeU1Wb1hEVEk1TURjeU9ERXhORFl5TVZvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBT1p6CnU5Sk8xYUhNSy9kM3cvbzRvOTZiMTJUU09BME5ZSXNFZ2N3bno3bTF1TW1XakhNR0dDZGtGWWFEVGlpVm5rMWcKTFJ6ZGpYd1k0b1hLZkoxVkNXazdGOFNHTnR2U0xHa0pZVUNtcmVNRng5TnNJREdUK0FqK0h0WG41WG5BWEpXUwpVektVVVRBSFZoVzV3UndmbldzY0FZWjN4MFlHY3UvclVVOXVkb0JWWjN5dVE3VzNsWHpSUDJlZ1MvUkF0dDUrCnl6ZWhlWXN4S1hXelVidlhON0U2dWRQbVlnWFFZMUgwR1FKaStmdVpWVXJkVVNnVXQ4cXVuZ2V4dmZrUEU2USsKRnpjTWRtdlpZUFRtMWVEdnZqU0tEOHpLUVliK0VFdVd3U0dPMmlKcVMwRmEzVGF6TGMwR2VqeHkwUGhSOU9FeQo5M0x4NE1BQkxTUjk4Z2k1SjlVQ0F3RUFBYU1qTUNFd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFHVWR2SmVRbXFXdGpRLzE3ek4rOUhsM0V5S2YKVDVWYVgyYlFiYWg1TVlYNXdjZy9uVWdRVi9EekJCTElKbVhCR3lQZ0d0MHRJSFJwZFowVGRyVGwwUDlia1FDcwpFeS9hUkh2SVc3KzZjdE9YM2dhU0NpZFA0aEJtanZtTU1RTHZxd2xORTk5a2FYRnNoWXNmelZYaFpaM2MrK0VvCmNueWFWdk5kd2dobTMwWUVKaFMraG1JYVJlQ3RZZjllVDJSUmxQOGN3K0V2cUNRbFRNbEQ2clpLMmtkSGNDTHoKQjE5SzcvUFFtOVJMSUd0VnVuOUgzTjNNVUx3aWtwTFpDdGJWcVQ1aldxeUU1cXByd3hLWEs1djlHSWovQWxRUwpzK01uaWFLZllqYmMwSy9UODlsSDhmUlM5MlY2Z0dOR3F6aUpXSDBLaEx2VGdRMURsK0RYT1BOcXJpVT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo= \
    CLIENTKEYDATA=LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBKzdQVmZkOEtWMGh0LytoWHJFbHdlNFlkSmtOVlIrdW96d1U2ZGtMdWFLbnV4bkI1CmtGTDMvVEw4M2VaNHhmUFQ4Sm9UL2R0Q3FqUWtDOGJoL1RWTWhmV0lrNDRXTVJVNlJaWVluY3VmUVJBSStvZVcKWHM1QUFyMWtNVzVxdGRtaGJaQnlSTW51WmUxSFRacnFITlFiNzNUUHcvREthQmgyWkZ5K3FoY0p1ZWI1dkpuQwp0NjVzQVRHUW8wL1BJcXdRVGlXelcwY1RLclE0UDN1aHE2eDAwZHNJeDJHNVRRVmx0UW1rZkU5dVRHMnNTcXdrCmhXQWw4MW11dVZ3SEpYMzRsNjFDU0NGNGdPVTlZc1FudXRBWlJJaFZkbldvWUpmNllKM01GL1VLK1lsb1JNZnUKOTNwdnN5QmlsUXNVaG9GMUZqdVRKUUpIcGdyaW80R0VoTkFnR3dJREFRQUJBb0lCQUU5RU9DUzJ2QXYyekdWKwpKellqdnArNEFiQU9IbXBTNWN1a2F0L1pmamxKNHQ5dGhtc1VKZk1BUHJBbko3dTNhUFJwb1lnZHArWHdHN1gxCndTKzd2RWlucFlaS2hlU1pPY3UyVkRSRmJ2YlBkUFJwQk1zQWl4b1J5TjdrVmdqRTY5aVVWOWdmKzhydnFiZmYKNUlDRnIvSitSL3Y5OWRCSWUraHBhTVlxRVM4UTFZdjVyVVdFZTFlamdNM29UZktjVHFTZnNYcWtBQ2lvaWFBOQpCMThaUy9YZDBjWnFSN1lablVIbSt5Q1pFK0Ria05IdTFHTkNTWk0yN0ZnZm9qTkJSUFZ5VFV0T213bTNDWlNyCm94dWpmSEhzcEVqbUtjMUVjTXhOMW9FbFkzWDZCMmVSek8rNzV0ZElTcEtreVBVRFZkZ3hweU1CSGlTWHFZQjgKMit2bUs4RUNnWUVBLzhYNzFCNVdNOWFtSk9WMjlWeWZSUmVEcndTdGJxNWtzU1ordjZWSnM0U2JjVnIzU2xneQpSVlZ2V3BKQkJRcEl4VmcxWW5BYlFlQTRXUDdjYmNhRmZqUWYwdDJCOTNOcHV1WUR5V3NXYys4WmRUelM2VXF1ClhUTTBrZWJ1SWdKaFU5MDdCbDFPTnZiUVZLK1pmZjhYeFJsRDlOc1RaQXpsREtCUVBPWU5MS0VDZ1lFQSsrenQKUm9PWGNWdXdvNDJibEFRcUlCcnVaYzFyOHlSRjM4WkNhUlpYVGtTT1h6SFI2bnJubWJ5OU41bG5wbDlKang5cgpWSkhYOEZraGFpNS9oVXB2eVdFUmliRkFRSFp0NHdRNy83UjVHN3Yvak5EaGcwdGVsNnhlRVB5U3RHR3l3c0dECkRjVCtDUmMzd2RtWC9xeEY1R01oWUtKZVQwZEN6MU0wVFJzSWR6c0NnWUJqZUF5Q3ByV2hmVldwdmE5d3BtK3UKUUFIUE84Tnk2dEZ2NzJlVmdtTlNORHo3YllRRVhwNVdSbTZDeTZRTG9MOUNPQmF5ektSZER5VDZ2MHJjU2pzNgpKRzFINVNzWkg4STdsQjVlNDQyYzBweVU4bTJYbXBxSzFsSVlkN1dlZGt5QmYrVG5pYnZVTmxJNHpQMmxlV0kyCkhhaEcvamZoVGY1NTFaSyt6RHpOWVFLQmdRQy8zODA4UnArQ3hCMytBNjI2QjQzNkUrajgrbjg4bWFUcWNidEYKQkxJTU42VGtGakxXVHpPMFlROFFtTE5jQVBrcW0vaUlXZWhJOCtuQ1VKWHBkQzgrQnNOdnh1T3o5VDl1aDF3WApQbUo3WUMyY0Y3K2EyejI1Y1p2WGZqZFNVWkx3U0tqRFJRVmk4UjhUY3VJVUl5dThibEFPcEx3Rno3V3Y2S1JPCkVjZlozd0tCZ1FEMW1XOUdaSkRmWmw3bmw2cENVdVMzU1F1M2tPRGFNL09IbDBwREFuMi9WOWJiWjBmQ2N3V0EKYnFsMHJZVnZDN1F3S2VhMVUxU1F5dnltRDlOUUNGdEFTbzJjYkZiVHliclZPQkUySkJ4Y01QZEdtSzRxalA0dwpXSy8yNHBGOFlDMVpHcGx2bGU2dUdWamkrNzhnMHZYQzAzeFhMdTVhS3RoYy9pbWMxd0xQaFE9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo= \
    CLIENTCERTDATA=LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM4akNDQWRxZ0F3SUJBZ0lJVFowalcwRGhnKzh3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB4T1RBM016RXhNVFEyTWpGYUZ3MHlNREEzTXpBeE1UUTJNakphTURReApGekFWQmdOVkJBb1REbk41YzNSbGJUcHRZWE4wWlhKek1Sa3dGd1lEVlFRREV4QnJkV0psY201bGRHVnpMV0ZrCmJXbHVNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQSs3UFZmZDhLVjBodC8raFgKckVsd2U0WWRKa05WUit1b3p3VTZka0x1YUtudXhuQjVrRkwzL1RMODNlWjR4ZlBUOEpvVC9kdENxalFrQzhiaAovVFZNaGZXSWs0NFdNUlU2UlpZWW5jdWZRUkFJK29lV1hzNUFBcjFrTVc1cXRkbWhiWkJ5Uk1udVplMUhUWnJxCkhOUWI3M1RQdy9ES2FCaDJaRnkrcWhjSnVlYjV2Sm5DdDY1c0FUR1FvMC9QSXF3UVRpV3pXMGNUS3JRNFAzdWgKcTZ4MDBkc0l4Mkc1VFFWbHRRbWtmRTl1VEcyc1Nxd2toV0FsODFtdXVWd0hKWDM0bDYxQ1NDRjRnT1U5WXNRbgp1dEFaUkloVmRuV29ZSmY2WUozTUYvVUsrWWxvUk1mdTkzcHZzeUJpbFFzVWhvRjFGanVUSlFKSHBncmlvNEdFCmhOQWdHd0lEQVFBQm95Y3dKVEFPQmdOVkhROEJBZjhFQkFNQ0JhQXdFd1lEVlIwbEJBd3dDZ1lJS3dZQkJRVUgKQXdJd0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFPWlJIY2VxUVloV2R3dGlVSTRIcHpDMktkMUp2amIzRWNKUAp3T2hyNS9iOVFialhlVUdvNEVxaUtnUGVrZmxTUmJ4Rzd4eXZ6dW1nQ24wdWVuTGJnWnhCOEhkTFMvcm9HQTlWCmNTZ3g3RzUzZkF2c1pDZkR3dWxIeUFNaWlVeGIybVMyeUd6dlEvVmIyekMvZzJTT0JVcjJEMWlvQjZldGtGZnEKbG9HQmdxK01NRUVCKzFmWU1kWTNBUSttYWhwTzM5R0dmc2cybTl4OW9mUHNwdmRNK2Ezak9admxKMm1PdlFYawppbUNMaVYvQm5OTkY1Z1k2ZDEzOVVuTDB1TllSSFNxdHJYUjBHUmROK0g3ajdnMmtraTZHMkV0UElmdDZ0WWYzCnI0ZEJzUDlGRVBNTnFGNkZ3c1ZjcUVpWWg2eVh0TUVVRHZmTlpxK2J2VWNuRnJoTkxTMD0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo= \
    DBFILE=jdbc:sqlite:/opt/zerocloud/users.db  \
    DBFILE.2=1.1.1.1 \
    TOMCAT_MAJOR=9 \
    TOMCAT_VERSION=9.0.22 \
    TOMCAT_HOME=/opt/tomcat \
    CATALINA_HOME=/opt/tomcat \
    CATALINA_OUT=/dev/null

RUN apk add --update curl openjdk8 && \
    curl -jksSL -o /tmp/apache-tomcat.tar.gz http://archive.apache.org/dist/tomcat/tomcat-${TOMCAT_MAJOR}/v${TOMCAT_VERSION}/bin/apache-tomcat-${TOMCAT_VERSION}.tar.gz && \
    gunzip /tmp/apache-tomcat.tar.gz && \
    tar -C /opt -xf /tmp/apache-tomcat.tar && \
    ln -s /opt/apache-tomcat-${TOMCAT_VERSION} ${TOMCAT_HOME} && \
    rm -rf ${TOMCAT_HOME}/webapps/* && \
    apk del curl && \
    rm -rf /tmp/* /var/cache/apk/*

COPY target/ROOT.war ${TOMCAT_HOME}/webapps/



CMD ["/opt/tomcat/bin/catalina.sh", "run"]
EXPOSE 8080